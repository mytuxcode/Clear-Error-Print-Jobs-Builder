# ğŸ–¨ï¸ Clear Error Print Jobs Builder

**PowerShell** script to automatically clear errored print jobs from Windows print servers.  
It includes an **interactive builder** that lets you create a **customized, self-contained cleanup script** â€” ready to run manually or on a schedule.

---

## ğŸš€ Overview

There are **two scripts** in this project:

### 1ï¸âƒ£ `Clear-ErrorPrintJobs-Builder.ps1`
An **interactive configuration tool** that:
- Prompts the user to enter one or more print servers (by Hostname or IP)
- Builds a **custom cleanup script** containing those servers
- Opens a **Save File dialog** so the user can choose where to save it
- Creates a **ready-to-run PowerShell script** for unattended execution

### 2ï¸âƒ£ `Clear-ErrorPrintJobs-Custom.ps1`
A **self-contained** PowerShell script generated by the Builder that:
- Loads the `PrintManagement` module
- Scans the listed print servers for **stuck or errored print jobs**
- Cancels each errored job automatically
- Displays progress and warnings in the console

---

## âš™ï¸ How It Works

1. Run the Builder:
   ```powershell
   .\Clear-ErrorPrintJobs-Builder.ps1
   ```
2. Enter each print server name or IP address when prompted.
3. When finished, the script opens a **Save As dialog**. Choose where to save your generated cleanup script.
4. The saved script (e.g. `Clear-ErrorPrintJobs-Custom.ps1`) will look like this:

   ```powershell
   Import-Module PrintManagement -ErrorAction Stop

   $PrintServers = @('PRINTSERVER01', 'PRINTSERVER02')

   foreach ($server in $PrintServers) {
       Write-Host "`n--- Checking print server: $server ---" -ForegroundColor Cyan
       # ... checks and clears errored jobs ...
   }
   ```

5. You can now run that saved script **directly** or **schedule it** to run automatically.

---

## ğŸ§° Setting Up in Task Scheduler

This section explains how to schedule your cleanup script to run **every 30 minutes** automatically.

### ğŸ•“ Scheduling the Script to Run Every 30 Minutes

1. **Open Task Scheduler**
   - Press `Win + R`, type `taskschd.msc`, and press **Enter**.

2. **Create a New Task**
   - In the right pane, select **Create Taskâ€¦**
   - Under the **General** tab:
     - Name: `Clear Error Print Jobs`
     - Description: `Automatically clears errored print jobs from all configured print servers`
     - Check âœ… *Run whether user is logged on or not*
     - Check âœ… *Run with highest privileges*

3. **Set the Trigger (every 30 minutes)**
   - Go to the **Triggers** tab â†’ click **Newâ€¦**
   - Begin the task: `On a schedule`
   - Select **Daily**
   - Set **Start time** (for example, 12:00 AM)
   - Under **Advanced settings:**
     - Check âœ… *Repeat task every:* â†’ choose **30 minutes**
     - For a duration of: **Indefinitely**
     - Make sure the trigger is **Enabled**
   - Click **OK**

4. **Set the Action**
   - Go to the **Actions** tab â†’ click **Newâ€¦**
   - Action: `Start a program`
   - **Program/script:**  
     ```
     powershell.exe
     ```
   - **Add arguments (replace path as needed):**
     ```
     -ExecutionPolicy Bypass -File "C:\Scripts\Clear-ErrorPrintJobs-Custom.ps1"
     ```
   - Click **OK**

5. **(Optional) Set Conditions**
   - Go to the **Conditions** tab.
   - Uncheck â€œStart the task only if the computer is on AC powerâ€ if running on a laptop.

6. **Save the Task**
   - Click **OK**
   - Enter your Windows credentials when prompted.

âœ… The script will now run every **30 minutes**, 24/7, automatically clearing any errored print jobs.

---

## ğŸ§  Requirements

- Windows Server 2016 or newer (or Windows 10/11 with admin rights)
- PowerShell 5.1 or newer
- `PrintManagement` module (included in Windows by default)

---

## ğŸ§© Example Console Output

```
--- Checking print server: E275PAPERCUT ---
ğŸ—‘ï¸  Cleared job ID 105 on printer 001-ADMIN-LJ
ğŸ—‘ï¸  Cleared job ID 108 on printer 001-LIB-PRN
âš ï¸  Could not cancel job ID 112 on printer 001-LAB-PRN: Access denied
```

---

## ğŸ§¾ Version Info

| Script | Version | Description |
|--------|----------|--------------|
| Clear-ErrorPrintJobs-Builder.ps1 | 3.1 | Interactive script generator |
| Clear-ErrorPrintJobs-Custom.ps1 | 1.0 | Generated cleanup script |

---

## ğŸ“œ License

This project is licensed under the **MIT License** â€” free to use, modify, and distribute.

---

## ğŸ‘¨â€ğŸ’» Author

**(TuxCode)**  
GitHub: [mytuxcode](https://github.com/mytuxcode)  
Email:....[mytuxcode@gmail.com](mailto:mytuxcode@gmail.com)

> â€œAutomation saves time â€” clean print queues save patience.â€
